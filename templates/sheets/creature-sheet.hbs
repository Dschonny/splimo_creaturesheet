<form class="{{cssClass}}" autocomplete="off">
    <header class="column flex-gap">
        <section class="row flex-gap">
            <div class="character-image">
                <img src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="92" width="92"
                    class="profile-img" />
            </div>
            <div class="column stretch">
                <input class="character-name" name="name" type="text" value="{{actor.name}}"
                    placeholder="{{localize 'splittermond.name' }}" />
                {{#unless limited}}
                <ul class="npcfeatures taglist" data-item-type="npcfeature">
                    {{#each itemsByType.npcfeature}}
                    <li class="taglist-item" data-item-id="{{this._id}}">
                        <div class="taglist-item-name">
                            <a data-action="edit-item">{{this.name}}</a>
                        </div>
                        <div class="taglist-item-actions">
                            <button class="button-inline" data-action="delete-item" type="button">
                                <i class="fa fa-trash" aria-hidden="true"></i>
                            </button>
                        </div>
                    </li>
                    {{/each}}
                    <li class="taglist-actions"><button class="button-inline" type="button" data-action="add-item"
                            data-render-sheet="true" data-item-type="npcfeature">
                            <i class="fa fa-plus-square" aria-hidden="true"></i>
                        </button></li>
                </ul>
                {{/unless}}
            </div>
        </section>
        {{#unless limited}}
        <section class="column">
            {{> "systems/splittermond/templates/sheets/actor/parts/focus-health.hbs" focus=data.system.focus
            health=data.system.health hasRestActions=false}}
            {{> "systems/splittermond/templates/sheets/actor/parts/derived-attributes.hbs"
            derivedAttributes=actor.derivedValues damageReduction=actor.damageReduction editable=false}}
        </section>
        {{/unless}}
    </header>
    {{#unless limited}}
    <nav class="sheet-navigation" data-group="primary">
        <a class="sheet-navigation-item" data-tab="biography">{{ localize "splittermond.biography" }}</a>
        <a class="sheet-navigation-item active" data-tab="general">{{ localize "splittermond.general" }}</a>
        <a class="sheet-navigation-item" data-tab="skills">{{ localize "splittermond.skills" }}</a>
        <a class="sheet-navigation-item" data-tab="spells">{{ localize "splittermond.spells" }}</a>
        <a class="sheet-navigation-item" data-tab="fight">{{ localize "splittermond.fight" }}</a>
        <a class="sheet-navigation-item" data-tab="inventory">{{ localize "splittermond.inventory" }}</a>
        <a class="sheet-navigation-item" data-tab="status">{{ localize "splittermond.status" }}</a>
    </nav>
    <main>
        <section class="tab" data-group="primary" data-tab="biography">
            {{editor data.system.biographyHTML target="system.biography" button=true owner=owner editable=editable}}
        </section>
        <section class="tab creature-general-tab" data-group="primary" data-tab="general">
            <div class="creature-general-left">
                {{!-- Attributes --}}
                <div class="list list-attributes">
                    <div class="list-header">
                        <h3>{{localize "splittermond.attributes"}}</h3>
                        <div class="value">{{localize "splittermond.value"}}</div>
                    </div>
                    <ul class="list-body">
                        {{#each actor.attributes as |attribute attributeId|}}
                        <li class="list-item attribute">
                            <label for="system.attributes.{{attributeId}}.value"
                                title="{{localize attribute.label.long}}">{{localize
                                attribute.label.long}}</label>
                            <div class="value">
                                <input name="system.attributes.{{attributeId}}.value" type="text" value="{{attribute.value}}"
                                    data-dtype="Number">
                            </div>
                        </li>
                        {{/each}}
                    </ul>
                </div>

                {{!-- Creature Info: Basis & Rolle --}}
                <div class="creature-info-box">
                    {{#if creatureInfo.basis}}
                    <p><strong>{{localize "CREATURE.Basis"}}:</strong> <span title="{{creatureInfo.basis.description}}">{{creatureInfo.basis.name}}</span></p>
                    {{/if}}
                    {{#if creatureInfo.rolle}}
                    <p><strong>{{localize "CREATURE.Rolle"}}:</strong> <span title="{{creatureInfo.rolle.description}}">{{creatureInfo.rolle.name}}</span></p>
                    {{/if}}
                </div>
            </div>

            <div class="creature-general-right">
                {{!-- NPC Features / Merkmale --}}
                {{#if itemsByType.npcfeature}}
                <div class="list">
                    <div class="list-header">
                        <h3>{{localize "CREATURE.Features"}}</h3>
                    </div>
                    <ul class="list-body taglist">
                        {{#each itemsByType.npcfeature}}
                        <li class="taglist-item" data-item-id="{{this._id}}" title="{{this.system.description}}">
                            <div class="taglist-item-name">{{this.name}}</div>
                        </li>
                        {{/each}}
                    </ul>
                </div>
                {{/if}}

                {{!-- Verfeinerungen --}}
                {{#if verfeinerungenByCategory}}
                <div class="list">
                    <div class="list-header">
                        <h3>{{localize "CREATURE.Verfeinerungen"}}</h3>
                    </div>
                    <div class="list-body">
                        {{#each verfeinerungenByCategory}}
                        <div class="refinement-category">
                            <h4>{{localize this.categoryKey}}</h4>
                            <ul class="taglist">
                                {{#each this.items}}
                                <li class="taglist-item" title="{{this.description}}">
                                    <div class="taglist-item-name">{{this.name}} ({{this.cost}})</div>
                                </li>
                                {{/each}}
                            </ul>
                        </div>
                        {{/each}}
                    </div>
                </div>
                {{/if}}
            </div>
        </section>
        <section class="tab creature-skills-tab" data-group="primary" data-tab="skills">
            <div class="creature-skills-left">
                {{!-- All Skills in simple two-column format --}}
                <div class="list skills" data-roll-type="skill">
                    <div class="list-header">
                        <h3>{{localize "splittermond.generalSkills"}}</h3>
                        <div class="list-actions">
                            <button class="button-inline" data-action="show-hide-skills" type="button">
                                {{#if hideSkills}}
                                <i class="fa fa-eye" aria-hidden="true"></i>
                                {{else}}
                                <i class="fa fa-eye-slash" aria-hidden="true"></i>
                                {{/if}}
                            </button>
                        </div>
                    </div>
                    <ol class="list-body skill-list">
                        {{#each generalSkills as |skill skillId|}}
                        <li class="list-item" data-skill="{{skillId}}">
                            <label>
                                <a class="rollable">{{localize skill.label}}</a>
                            </label>
                            <div class="value creature-skill-value">
                                <input name="system.skills.{{skillId}}.value" type="text" value="{{skill.points}}"
                                    data-dtype="Number" class="skill-base-value">
                                {{#unless (eq skill.value skill.points)}}
                                <span class="skill-total-value" title="{{localize 'CREATURE.SkillTotalWithModifiers'}}">({{skill.value}})</span>
                                {{/unless}}
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                    <div class="list-header">
                        <h3>{{localize "splittermond.fightingSkills"}}</h3>
                    </div>
                    <ol class="list-body skill-list">
                        {{#each fightingSkills as |skill skillId|}}
                        <li class="list-item" data-skill="{{skillId}}">
                            <label>
                                <a class="rollable">{{localize skill.label}}</a>
                            </label>
                            <div class="value creature-skill-value">
                                <input name="system.skills.{{skillId}}.value" type="text" value="{{skill.points}}"
                                    data-dtype="Number" class="skill-base-value">
                                {{#unless (eq skill.value skill.points)}}
                                <span class="skill-total-value" title="{{localize 'CREATURE.SkillTotalWithModifiers'}}">({{skill.value}})</span>
                                {{/unless}}
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                    <div class="list-header">
                        <h3>{{localize "splittermond.magicSkills"}}</h3>
                    </div>
                    <ol class="list-body skill-list">
                        {{#each magicSkills as |skill skillId|}}
                        <li class="list-item" data-skill="{{skillId}}">
                            <label>
                                <a class="rollable">{{localize skill.label}}</a>
                            </label>
                            <div class="value creature-skill-value">
                                <input name="system.skills.{{skillId}}.value" type="text" value="{{skill.points}}"
                                    data-dtype="Number" class="skill-base-value">
                                {{#unless (eq skill.value skill.points)}}
                                <span class="skill-total-value" title="{{localize 'CREATURE.SkillTotalWithModifiers'}}">({{skill.value}})</span>
                                {{/unless}}
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                </div>
            </div>

            <div class="creature-skills-right">
                {{> "systems/splittermond/templates/sheets/actor/parts/mastery-list.hbs"
                masteriesBySkill=masteriesBySkill generalSkills=generalSkills fightingSkills=fightingSkills
                magicSkills=magicSkills}}

                {{!-- Abrichtungen --}}
                {{#if abrichtungenByCategory}}
                <div class="list abrichtungen">
                    <div class="list-header">
                        <h3>{{localize "CREATURE.Abrichtungen"}}</h3>
                    </div>
                    <ol class="list-body">
                        {{#each abrichtungenByCategory}}
                        <li class="list-item">
                            <label>{{localize this.categoryKey}}</label>
                            <ul class="taglist item-list">
                                {{#each this.items}}
                                <li class="taglist-item item" title="{{this.description}}">
                                    <div class="taglist-item-name">{{this.name}}</div>
                                </li>
                                {{/each}}
                            </ul>
                        </li>
                        {{/each}}
                    </ol>
                </div>
                {{/if}}
            </div>
        </section>
        <section class="tab" data-group="primary" data-tab="spells">
            <div>
                {{> "systems/splittermond/templates/sheets/actor/parts/spells-list.hbs" spellsBySkill=spellsBySkill
                channeledSpells=data.system.focus.channeled.entries}}

                {{#if unassignedSpells.length}}
                <div class="list unassigned-spells">
                    <div class="list-header">
                        <h3>{{localize "CREATURE.UnassignedSpells"}}</h3>
                    </div>
                    <ul class="list-body taglist">
                        {{#each unassignedSpells}}
                        <li class="taglist-item" data-item-id="{{this._id}}" title="{{this.system.description}}">
                            <div class="taglist-item-name">
                                {{this.name}}
                                {{#if this.system.spellSchool}}
                                <span class="spell-school">[{{this.system.spellSchool}}{{#if this.system.spellGrade}} {{this.system.spellGrade}}{{/if}}]</span>
                                {{/if}}
                            </div>
                            <div class="taglist-item-actions">
                                <button class="button-inline" data-action="edit-item" type="button">
                                    <i class="fa fa-edit" aria-hidden="true"></i>
                                </button>
                                <button class="button-inline" data-action="delete-item" type="button">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/each}}
                    </ul>
                </div>
                {{/if}}
            </div>
        </section>
        <section class="tab" data-group="primary" data-tab="fight">
            <div>
                {{> "systems/splittermond/templates/sheets/actor/parts/combat-actions.hbs"
                activeDefense=actor.activeDefense attacks=actor.attacks}}
            </div>
        </section>
        <section class="tab" data-group="primary" data-tab="inventory">
            <div>
                {{> "systems/splittermond/templates/sheets/actor/parts/inventory-list.hbs" itemsByType=itemsByType
                currency=data.system.currency}}
            </div>
        </section>
        <section class="tab" data-group="primary" data-tab="status">
            {{> "systems/splittermond/templates/sheets/actor/parts/status-tab.hbs"
            channeledHealthEntries=data.system.health.channeled.entries statuseffects=itemsByType.statuseffect
            spelleffects=itemsByType.spelleffect
            hasRestActions=false}}
        </section>

    </main>
    {{/unless}}
</form>
